{"version":3,"sources":["../../src/routes/createAccount.js"],"names":["router","Router","get","req","res","findOne","superAgent","agent","newPlayer","account","username","password","passcode","activate","_id","save","then","newOne","player","json","isEmpty","newAgent","credit","agents","push","newSuperAgent","console","log","catch","err","populate"],"mappings":"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","file":"createAccount.js","sourcesContent":["import moment from 'moment';\nimport _ from 'lodash';\n\nimport SuperAgent from '../models/SuperAgent';\nimport Agent from '../models/Agent';\nimport Player from '../models/Player';\n\nimport updatePlayerStatusAfterOrder from '../updateDB/utils/updatePlayerStatusAfterOrder'\n\nimport express from 'express';\nconst router = express.Router();\n\nrouter.get('/create-player', async (req, res) => {\n\tconst superAgent = await SuperAgent.findOne({ 'account.username': 'boss' })\n\tconst agent = await Agent.findOne({'account.username': 'diamond'})\n\tlet newPlayer = new Player({\n\t\taccount: {\n\t\t\tusername: 'f',\n\t\t\tpassword: '1234',\n\t\t\tpasscode: '4321',\n\t\t\tactivate: true,\n\t\t},\n\t\tsuperAgent: superAgent._id,\n\t\tagent: agent._id\n\t})\n\tconst player = await newPlayer.save().then(async newOne => {\n\t\tawait updatePlayerStatusAfterOrder(newOne._id)\n\t})\n\t// await agent.players.push(player._id)\n\t// await agent.save()\n\t// await superAgent.players.push(player._id)\n\t// await superAgent.save()\n\n\tres.json(player)\n})\n\n\nrouter.get('/create-agent', async (req, res) => {\n\tconst superAgent = await SuperAgent.findOne({ 'account.username': 'boss' })\n\tif(!_.isEmpty(superAgent)){\n\t\tlet newAgent = new Agent({\n\t\t\taccount: {\n\t\t\t\tusername: 'diamond',\n\t\t\t\tpassword: '1234',\n\t\t\t\tpasscode: '4321',\n\t\t\t\tactivate: true,\n\t\t\t},\n\t\t\tsuperAgent: superAgent._id,\n\t\t\tcredit: 0\n\t\t})\n\t\tconst agent = await newAgent.save()\n\t\tsuperAgent.agents.push(agent._id)\n\t\tawait superAgent.save()\n\t\tres.json('done')\n\t}else{\n\t\tres.json('super agent not found')\n\t}\n})\n\n\nrouter.get('/create-super-agent', (req, res) => {\n\tlet newSuperAgent = new SuperAgent({\n\t\taccount: {\n\t\t\tusername: 'boss',\n\t\t\tpassword: '1234',\n\t\t\tpasscode: '4321',\n\t\t\tactivate: true\n\t\t}\n\t})\n\tnewSuperAgent.save().then(() => { \n\t\tconsole.log('saved superAgent') \n\t\tres.json('saved superAgent')\n\t}).catch(err => { throw err })\n})\n\nrouter.get('/agent-info', (req, res) => {\n\tAgent.findOne({ 'account.username': 'diamond' }).populate('players').then(agent => {\n\t\tres.json(agent)\n\t})\n})\n\nexport default router;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}