{"version":3,"sources":["../../src/routes/createAccount.js"],"names":["router","Router","get","req","res","find","players","Promise","all","map","player","_id","then","json","findOne","superAgent","agent","newPlayer","account","username","password","passcode","activate","save","newOne","isEmpty","newAgent","credit","agents","push","newSuperAgent","console","log","catch","err","populate"],"mappings":"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","file":"createAccount.js","sourcesContent":["import moment from 'moment';\nimport _ from 'lodash';\n\nimport SuperAgent from '../models/SuperAgent';\nimport Agent from '../models/Agent';\nimport Player from '../models/Player';\n\nimport updatePlayerStatusAfterOrder from '../updateDB/utils/updatePlayerStatusAfterOrder'\n\nimport express from 'express';\nconst router = express.Router();\n\nrouter.get('/setup', async (req, res) => {\n\tconst players = await Player.find({})\n\tawait Promise.all(players.map(async player => {\n\t\tawait updatePlayerStatusAfterOrder(player._id)\n\t})).then(() => {\n\t\tres.json('done')\n\t})\n})\n\n\nrouter.get('/create-player', async (req, res) => {\n\tconst superAgent = await SuperAgent.findOne({ 'account.username': 'boss' })\n\tconst agent = await Agent.findOne({'account.username': 'diamond'})\n\tlet newPlayer = new Player({\n\t\taccount: {\n\t\t\tusername: 'f',\n\t\t\tpassword: '1234',\n\t\t\tpasscode: '4321',\n\t\t\tactivate: true,\n\t\t},\n\t\tsuperAgent: superAgent._id,\n\t\tagent: agent._id\n\t})\n\tconst player = await newPlayer.save().then(async newOne => {\n\t\tawait updatePlayerStatusAfterOrder(newOne._id)\n\t})\n\t// await agent.players.push(player._id)\n\t// await agent.save()\n\t// await superAgent.players.push(player._id)\n\t// await superAgent.save()\n\n\tres.json(player)\n})\n\n\nrouter.get('/create-agent', async (req, res) => {\n\tconst superAgent = await SuperAgent.findOne({ 'account.username': 'boss' })\n\tif(!_.isEmpty(superAgent)){\n\t\tlet newAgent = new Agent({\n\t\t\taccount: {\n\t\t\t\tusername: 'diamond',\n\t\t\t\tpassword: '1234',\n\t\t\t\tpasscode: '4321',\n\t\t\t\tactivate: true,\n\t\t\t},\n\t\t\tsuperAgent: superAgent._id,\n\t\t\tcredit: 0\n\t\t})\n\t\tconst agent = await newAgent.save()\n\t\tsuperAgent.agents.push(agent._id)\n\t\tawait superAgent.save()\n\t\tres.json('done')\n\t}else{\n\t\tres.json('super agent not found')\n\t}\n})\n\n\nrouter.get('/create-super-agent', (req, res) => {\n\tlet newSuperAgent = new SuperAgent({\n\t\taccount: {\n\t\t\tusername: 'boss',\n\t\t\tpassword: '1234',\n\t\t\tpasscode: '4321',\n\t\t\tactivate: true\n\t\t}\n\t})\n\tnewSuperAgent.save().then(() => { \n\t\tconsole.log('saved superAgent') \n\t\tres.json('saved superAgent')\n\t}).catch(err => { throw err })\n})\n\nrouter.get('/agent-info', (req, res) => {\n\tAgent.findOne({ 'account.username': 'diamond' }).populate('players').then(agent => {\n\t\tres.json(agent)\n\t})\n})\n\nexport default router;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}