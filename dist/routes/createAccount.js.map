{"version":3,"sources":["../../src/routes/createAccount.js"],"names":["router","Router","get","req","res","find","players","Promise","all","map","player","_id","then","json","findOne","superAgent","agent","newPlayer","account","username","password","passcode","activate","save","newOne","isEmpty","newAgent","newSuperAgent","console","log","catch","err","populate","newResult","utc","uniqueId","result"],"mappings":";;;;;;AAAA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AA6EA;;;;;;AA5EA,IAAMA,SAAS,kBAAQC,MAAR,EAAf;;AAEAD,OAAOE,GAAP,CAAW,QAAX;AAAA,sDAAqB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACE,iBAAOC,IAAP,CAAY,EAAZ,CADF;;AAAA;AACdC,aADc;AAAA;AAAA,aAEdC,QAAQC,GAAR,CAAYF,QAAQG,GAAR;AAAA,6DAAY,iBAAMC,MAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACvB,4CAA6BA,OAAOC,GAApC,CADuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAZ;;AAAA;AAAA;AAAA;AAAA,UAAZ,EAEFC,IAFE,CAEG,YAAM;AACdR,WAAIS,IAAJ,CAAS,MAAT;AACA,OAJK,CAFc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAArB;;AAAA;AAAA;AAAA;AAAA;;AAUAb,OAAOE,GAAP,CAAW,gBAAX;AAAA,uDAA6B,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACH,qBAAWU,OAAX,CAAmB,EAAE,oBAAoB,MAAtB,EAAnB,CADG;;AAAA;AACtBC,gBADsB;AAAA;AAAA,aAER,gBAAMD,OAAN,CAAc,EAAC,oBAAoB,SAArB,EAAd,CAFQ;;AAAA;AAEtBE,WAFsB;AAGxBC,eAHwB,GAGZ,qBAAW;AAC1BC,gBAAS;AACRC,kBAAU,GADF;AAERC,kBAAU,MAFF;AAGRC,kBAAU,MAHF;AAIRC,kBAAU;AAJF,QADiB;AAO1BP,mBAAYA,WAAWJ,GAPG;AAQ1BK,cAAOA,MAAML;AARa,OAAX,CAHY;AAAA;AAAA,aAaPM,UAAUM,IAAV,GAAiBX,IAAjB;AAAA,6DAAsB,kBAAMY,MAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACpC,4CAA6BA,OAAOb,GAApC,CADoC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAtB;;AAAA;AAAA;AAAA;AAAA,UAbO;;AAAA;AAatBD,YAbsB;;AAgB5B;AACA;AACA;AACA;;AAEAN,UAAIS,IAAJ,CAASH,MAAT;;AArB4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAA7B;;AAAA;AAAA;AAAA;AAAA;;AAyBAV,OAAOE,GAAP,CAAW,eAAX;AAAA,uDAA4B,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACF,qBAAWU,OAAX,CAAmB,EAAE,oBAAoB,MAAtB,EAAnB,CADE;;AAAA;AACrBC,gBADqB;;AAAA,UAEvB,iBAAEU,OAAF,CAAUV,UAAV,CAFuB;AAAA;AAAA;AAAA;;AAGtBW,cAHsB,GAGX,oBAAU;AACxBR,gBAAS;AACRC,kBAAU;AADF;AADe,OAAV,CAHW;AAAA;AAAA,aAQNO,SAASH,IAAT,EARM;;AAAA;AAQpBP,WARoB;;AAS5B;AACA;AACEZ,UAAIS,IAAJ,CAAS,MAAT;AAX0B;AAAA;;AAAA;AAa1BT,UAAIS,IAAJ,CAAS,uBAAT;;AAb0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAA5B;;AAAA;AAAA;AAAA;AAAA;;AAkBAb,OAAOE,GAAP,CAAW,qBAAX,EAAkC,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC/C,KAAIuB,gBAAgB,yBAAe;AAClCT,WAAS;AACRC,aAAU,MADF;AAERC,aAAU,MAFF;AAGRC,aAAU,MAHF;AAIRC,aAAU;AAJF;AADyB,EAAf,CAApB;AAQAK,eAAcJ,IAAd,GAAqBX,IAArB,CAA0B,YAAM;AAC/BgB,UAAQC,GAAR,CAAY,kBAAZ;AACAzB,MAAIS,IAAJ,CAAS,kBAAT;AACA,EAHD,EAGGiB,KAHH,CAGS,eAAO;AAAE,QAAMC,GAAN;AAAW,EAH7B;AAIA,CAbD;;AAeA/B,OAAOE,GAAP,CAAW,aAAX,EAA0B,UAACC,GAAD,EAAMC,GAAN,EAAc;AACvC,iBAAMU,OAAN,CAAc,EAAE,oBAAoB,SAAtB,EAAd,EAAiDkB,QAAjD,CAA0D,SAA1D,EAAqEpB,IAArE,CAA0E,iBAAS;AAClFR,MAAIS,IAAJ,CAASG,KAAT;AACA,EAFD;AAGA,CAJD;;AAQAhB,OAAOE,GAAP,CAAW,gBAAX,EAA6B,UAACC,GAAD,EAAMC,GAAN,EAAc;;AAE1C,KAAI6B,YAAY,qBAAW;;AAEzB,mBAAkB,8BAFO;AAGzB,cAAY,gCAHa;AAItB,WAAU,UAJY;AAKtB,aAAY,MALU;AAMtB,YAAW,SANW;AAOtB,YAAW,EAPW;AAQtB,aAAY,qCARU;AAStB,eAAc,iBAAOC,GAAP,CAAW,0BAAX,CATQ;AAUtB,cAAa,iBAAOA,GAAP,CAAW,0BAAX,CAVS;AAWtB,YAAW,UAXW;AAYtB,WAAU;AACN,gBAAc,EADR;AAEN,gBAAc;AAFR,GAZY;AAgBtB,UAAS;AACL,cAAY,KADP;AAEL,WAAS,aAFJ;AAGL,cAAY,KAHP;AAIL,WAAS;AAJJ,GAhBa;AAsBtB,YAAW;AACP,eAAa,QADN;AAEP,SAAO;AAFA;AAtBW,EAAX,CAAhB;;AA4BA,kBAAOpB,OAAP,CAAe,EAAEqB,UAAUF,UAAUE,QAAtB,EAAf,EAAiDvB,IAAjD,CAAsD,kBAAU;AAC/D,MAAG,iBAAEa,OAAF,CAAUW,MAAV,CAAH,EAAqB;AACpBH,aAAUV,IAAV,GAAiBX,IAAjB,CAAsB,YAAM;AAAER,QAAIS,IAAJ,CAAS,MAAT;AAAiB,IAA/C;AACA,GAFD,MAEK;AACJT,OAAIS,IAAJ,CAAS,SAAT;AACA;AACD,EAND;AAUA,CAxCD;;kBA4Ceb,M","file":"createAccount.js","sourcesContent":["import moment from 'moment';\nimport _ from 'lodash';\n\nimport SuperAgent from '../models/SuperAgent';\nimport Agent from '../models/Agent';\nimport Player from '../models/Player';\n\nimport updatePlayerStatusAfterOrder from '../updateDB/utils/updatePlayerStatusAfterOrder'\n\nimport express from 'express';\nconst router = express.Router();\n\nrouter.get('/setup', async (req, res) => {\n\tconst players = await Player.find({})\n\tawait Promise.all(players.map(async player => {\n\t\tawait updatePlayerStatusAfterOrder(player._id)\n\t})).then(() => {\n\t\tres.json('done')\n\t})\n})\n\n\nrouter.get('/create-player', async (req, res) => {\n\tconst superAgent = await SuperAgent.findOne({ 'account.username': 'boss' })\n\tconst agent = await Agent.findOne({'account.username': 'diamond'})\n\tlet newPlayer = new Player({\n\t\taccount: {\n\t\t\tusername: 'f',\n\t\t\tpassword: '1234',\n\t\t\tpasscode: '4321',\n\t\t\tactivate: true,\n\t\t},\n\t\tsuperAgent: superAgent._id,\n\t\tagent: agent._id\n\t})\n\tconst player = await newPlayer.save().then(async newOne => {\n\t\tawait updatePlayerStatusAfterOrder(newOne._id)\n\t})\n\t// await agent.players.push(player._id)\n\t// await agent.save()\n\t// await superAgent.players.push(player._id)\n\t// await superAgent.save()\n\n\tres.json(player)\n})\n\n\nrouter.get('/create-agent', async (req, res) => {\n\tconst superAgent = await SuperAgent.findOne({ 'account.username': 'boss' })\n\tif(!_.isEmpty(superAgent)){\n\t\tlet newAgent = new Agent({\n\t\t\taccount: {\n\t\t\t\tusername: 'diamond',\n\t\t\t}\n\t\t})\n\t\tconst agent = await newAgent.save()\n//\t\tsuperAgent.agents.push(agent._id)\n//\t\tawait superAgent.save()\n\t\tres.json('done')\n\t}else{\n\t\tres.json('super agent not found')\n\t}\n})\n\n\nrouter.get('/create-super-agent', (req, res) => {\n\tlet newSuperAgent = new SuperAgent({\n\t\taccount: {\n\t\t\tusername: 'boss',\n\t\t\tpassword: '1234',\n\t\t\tpasscode: '4321',\n\t\t\tactivate: true\n\t\t}\n\t})\n\tnewSuperAgent.save().then(() => { \n\t\tconsole.log('saved superAgent') \n\t\tres.json('saved superAgent')\n\t}).catch(err => { throw err })\n})\n\nrouter.get('/agent-info', (req, res) => {\n\tAgent.findOne({ 'account.username': 'diamond' }).populate('players').then(agent => {\n\t\tres.json(agent)\n\t})\n})\n\nimport { Result } from '../models/EventOdd';\n\nrouter.get('/create-result', (req, res) => {\n\n\tlet newResult = new Result({\n\n\t\t\t\"eventResultId\" : \"pickMon_College_GAME_1414713\",\n\t\t\t\"uniqueId\": \"221_222_FOOTBALL_GAME_08312017\",\n\t\t    \"sport\" : \"Football\",\n\t\t    \"oddType\" : \"Game\",\n\t\t    \"league\" : \"College\",\n\t\t    \"region\" : \"\",\n\t\t    \"details\" : \"Presbyterian College At Wake Forest\",\n\t\t    \"matchTime\" : moment.utc(\"2017-08-31T22:30:00.000Z\"),\n\t\t    \"expireAt\" : moment.utc(\"2017-09-03T11:00:00.000Z\"),\n\t\t    \"status\" : \"Finished\",\n\t\t    \"score\" : {\n\t\t        \"awayScore\" : 51,\n\t\t        \"homeScore\" : 7\n\t\t    },\n\t\t    \"team\" : {\n\t\t        \"awayROT\" : \"222\",\n\t\t        \"away\" : \"Wake Forest\",\n\t\t        \"homeROT\" : \"221\",\n\t\t        \"home\" : \"Presbyterian College\"\n\t\t    },\n\t\t    \"source\" : {\n\t\t        \"provider\" : \"custom\",\n\t\t        \"id\" : \"0\"\n\t\t    }\n\t\t})\n\n\tResult.findOne({ uniqueId: newResult.uniqueId }).then(result => {\n\t\tif(_.isEmpty(result)){\n\t\t\tnewResult.save().then(() => { res.json('done')})\n\t\t}else{\n\t\t\tres.json('existed')\n\t\t}\n\t})\n\n\t\n\n})\n\n\n\nexport default router;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}