{"version":3,"sources":["../../../../src/routes/player/ctrls/fetchHistoryBet.js"],"names":["fetchHistoryBet","req","res","weekNum","body","find","user","_id","$gte","subtract","startOf","$lte","endOf","historyBetList","json"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;;;;;AAEA,IAAMA;AAAA,sDAAkB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAEfC,aAFe,GAEHF,IAAIG,IAFD,CAEfD,OAFe;AAAA;AAAA,aAGM,qBAAWE,IAAX,CAAgB,EAAE,gBAAgBJ,IAAIK,IAAJ,CAASC,GAA3B,EAAgC,YAAY,EAACC,MAAM,wBAASC,QAAT,CAAkBN,OAAlB,EAA2B,GAA3B,EAAgCO,OAAhC,CAAwC,SAAxC,CAAP,EAA2DC,MAAM,wBAASF,QAAT,CAAkBN,OAAlB,EAA2B,GAA3B,EAAgCS,KAAhC,CAAsC,SAAtC,CAAjE,EAA5C,EAAhB,CAHN;;AAAA;AAGjBC,oBAHiB;;;AAKvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEAX,UAAIY,IAAJ,CAASD,cAAT;;AA1BuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAlB;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBA+Beb,e","file":"fetchHistoryBet.js","sourcesContent":["import { HistoryBet } from '../../../models/BetOrder';\nimport _ from 'lodash'\nimport moment from 'moment'\n\nconst fetchHistoryBet = async (req, res) => {\n\n\tconst { weekNum } = req.body\n\tconst historyBetList = await HistoryBet.find({ 'owner.player': req.user._id, 'closedAt': {$gte: moment().subtract(weekNum, 'w').startOf('isoWeek'), $lte: moment().subtract(weekNum, 'w').endOf('isoWeek') } })\n\n\t// let historyBets = {\n\t// \thistoryBetList: historyBetList,\n\t// \tweekSummary: {\n\t// \t\t[moment().startOf('isoWeek').subtract(weekNum, 'w').add(0, 'd').format('MMM DD')]: { bets: 0, amount: 0 },\n\t// \t\t[moment().startOf('isoWeek').subtract(weekNum, 'w').add(1, 'd').format('MMM DD')]: { bets: 0, amount: 0 },\n\t// \t\t[moment().startOf('isoWeek').subtract(weekNum, 'w').add(2, 'd').format('MMM DD')]: { bets: 0, amount: 0 },\n\t// \t\t[moment().startOf('isoWeek').subtract(weekNum, 'w').add(3, 'd').format('MMM DD')]: { bets: 0, amount: 0 },\n\t// \t\t[moment().startOf('isoWeek').subtract(weekNum, 'w').add(4, 'd').format('MMM DD')]: { bets: 0, amount: 0 },\n\t// \t\t[moment().startOf('isoWeek').subtract(weekNum, 'w').add(5, 'd').format('MMM DD')]: { bets: 0, amount: 0 },\n\t// \t\t[moment().startOf('isoWeek').subtract(weekNum, 'w').add(6, 'd').format('MMM DD')]: { bets: 0, amount: 0 }\n\t// \t}\n\t// }\n\n\n\t// if(!_.isEmpty(historyBetList)){\n\t// \thistoryBetList.forEach(historyBet => {\n\t// \t\thistoryBets.weekSummary[moment(historyBet.closedAt).format('MMM DD')].amount += Number(historyBet.resultAmount);\n\t// \t\thistoryBets.weekSummary[moment(historyBet.closedAt).format('MMM DD')].bets++;\n\t// \t})\n\t// }\n\n\tres.json(historyBetList)\n\n}\n\n\nexport default fetchHistoryBet\n\n"]}