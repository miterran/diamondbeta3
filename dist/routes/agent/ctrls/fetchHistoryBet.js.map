{"version":3,"sources":["../../../../src/routes/agent/ctrls/fetchHistoryBet.js"],"names":["fetchHistoryBet","req","res","weekNum","body","find","user","_id","$gte","subtract","startOf","$lte","endOf","populate","path","select","historyBetList","json"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;;;;;AAEA,IAAMA;AAAA,sDAAkB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEdC,aAFc,GAEFF,IAAIG,IAFF,CAEdD,OAFc;AAAA;AAAA,aAGO,qBAAWE,IAAX,CAAgB;AAC5C,sBAAeJ,IAAIK,IAAJ,CAASC,GADoB;AAE5C,mBAAY,EAACC,MAAM,wBAASC,QAAT,CAAkBN,OAAlB,EAA2B,GAA3B,EAAgCO,OAAhC,CAAwC,SAAxC,CAAP,EAA2DC,MAAM,wBAASF,QAAT,CAAkBN,OAAlB,EAA2B,GAA3B,EAAgCS,KAAhC,CAAsC,SAAtC,CAAjE;AAFgC,OAAhB,EAG1BC,QAH0B,CAGjB;AACXC,aAAM,cADK;AAEXC,eAAQ;AAFG,OAHiB,CAHP;;AAAA;AAGhBC,oBAHgB;;AAUtBd,UAAIe,IAAJ,CAASD,cAAT;AAVsB;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAlB;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBAkBehB,e","file":"fetchHistoryBet.js","sourcesContent":["import { HistoryBet } from '../../../models/BetOrder';\nimport _ from 'lodash'\nimport moment from 'moment'\n\nconst fetchHistoryBet = async (req, res) => {\n\ttry{\n\t\tconst { weekNum } = req.body\n\t\tconst historyBetList = await HistoryBet.find({ \n\t\t\t'owner.agent': req.user._id, \n\t\t\t'closedAt': {$gte: moment().subtract(weekNum, 'w').startOf('isoWeek'), $lte: moment().subtract(weekNum, 'w').endOf('isoWeek') } \n\t\t}).populate({ \n\t\t\tpath: 'owner.player', \n\t\t\tselect: 'account.username'\n\t\t})\n\t\tres.json(historyBetList)\n\t}catch(err){\n\t\tthrow err\n\t}\n\n}\n\n\nexport default fetchHistoryBet\n\n"]}