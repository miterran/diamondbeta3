{"version":3,"sources":["../../../../src/routes/agent/ctrls/editPlayerSetting.js"],"names":["editPlayerSetting","req","res","body","playerId","maxParlay","maxWin","maxWager","minRisk","weeklyStartCredit","playerPass","amountGap","playerNewState","isEmpty","password","passcode","findOneAndUpdate","Types","ObjectId","$set","new","player","status","send"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AAEA,IAAMA;AAAA,sDAAoB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEkED,IAAIE,IAFtE,EAEhBC,QAFgB,aAEhBA,QAFgB,EAENC,SAFM,aAENA,SAFM,EAEKC,MAFL,aAEKA,MAFL,EAEaC,QAFb,aAEaA,QAFb,EAEuBC,OAFvB,aAEuBA,OAFvB,EAEgCC,iBAFhC,aAEgCA,iBAFhC,EAEmDC,UAFnD,aAEmDA,UAFnD;AAIpBC,eAJoB,GAIR,EAJQ;AAAA,oBAKjB,IALiB;AAAA,sCAMlBJ,YAAY,GANM,wBAUlBA,WAAW,GAAX,IAAkBA,YAAY,IAVZ,yBAclBA,WAAW,IAAX,IAAmBA,YAAY,IAdb,yBAkBlBA,WAAW,IAlBO;AAAA;;AAAA;AAO1B;AACII,kBAAY,EAAZ;AARsB;;AAAA;AAW1B;AACIA,kBAAY,EAAZ;AAZsB;;AAAA;AAe1B;AACIA,kBAAY,EAAZ;AAhBsB;;AAAA;AAmB1B;AACIA,kBAAY,GAAZ;AApBsB;;AAAA;AAAA;;AAAA;AA0BpBC,oBA1BoB,GA0BH;AACpB,mCAA4BP,SADR;AAEpB,gCAAyBC,MAFL;AAGpB,kCAA2BC,QAHP;AAIpB,iCAA0BC,OAJN;AAKpB,2CAAoCC,iBALhB;AAMpB,mCAA4BE;AANR,OA1BG;;;AAmCxB,UAAG,CAAC,iBAAEE,OAAF,CAAUH,WAAWI,QAArB,CAAJ,EAAoCF,eAAe,kBAAf,IAAqCF,WAAWI,QAAhD;AACpC,UAAG,CAAC,iBAAED,OAAF,CAAUH,WAAWK,QAArB,CAAJ,EAAoCH,eAAe,kBAAf,IAAqCF,WAAWK,QAAhD;;AApCZ;AAAA,aAsCH,iBAAOC,gBAAP,CAAwB,EAAE,OAAO,mBAASC,KAAT,CAAeC,QAAf,CAAwBd,QAAxB,CAAT,EAAxB,EAAsE,EAACe,MAAMP,cAAP,EAAtE,EAA8F,EAACQ,KAAK,IAAN,EAA9F,CAtCG;;AAAA;AAsClBC,YAtCkB;AAAA;AAAA,aAuClB,4CAA6BjB,QAA7B,CAvCkB;;AAAA;AAwCxBF,UAAIoB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,gBAArB;AAxCwB;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAApB;;AAAA;AAAA;AAAA;AAAA,GAAN;kBA6CevB,iB","file":"editPlayerSetting.js","sourcesContent":["import Player from '../../../models/Player';\nimport mongoose from 'mongoose';\nimport _ from 'lodash'\nimport updatePlayerStatusAfterOrder from '../../../updateDB/updateUser/updatePlayerStatusAfterOrder';\n\nconst editPlayerSetting = async (req, res) => {\n\ttry{\n\t\tconst { playerId, maxParlay, maxWin, maxWager, minRisk, weeklyStartCredit, playerPass } = req.body\n\n\t\tlet amountGap = 10\n\t\tswitch(true){\n\t\t\tcase maxWager <= 500:\n//\t\t\tcase minRisk < 50:\n\t\t\t\tamountGap = 10\n\t\t\t\tbreak;\n\t\t\tcase maxWager > 500 && maxWager <= 1000:\n//\t\t\tcase minRisk >= 50 && minRisk < 100:\n\t\t\t\tamountGap = 20\n\t\t\t\tbreak;\n\t\t\tcase maxWager > 1000 && maxWager <= 3000:\n//\t\t\tcase minRisk >= 100 && minRisk < 300:\n\t\t\t\tamountGap = 50\n\t\t\t\tbreak;\n\t\t\tcase maxWager > 3000:\n//\t\t\tcase minRisk >= 300:\n\t\t\t\tamountGap = 100\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn\n\t\t}\n\n\t\tlet playerNewState = {\n\t\t\t'defaultSetting.maxParlay': maxParlay,\n\t\t\t'defaultSetting.maxWin': maxWin,\n\t\t\t'defaultSetting.maxWager': maxWager,\n\t\t\t'defaultSetting.minRisk': minRisk,\n\t\t\t'defaultSetting.weeklyStartCredit': weeklyStartCredit,\n\t\t\t'defaultSetting.amountGap': amountGap,\n\t\t}\n\n\t\tif(!_.isEmpty(playerPass.password)) playerNewState['account.password'] = playerPass.password\n\t\tif(!_.isEmpty(playerPass.passcode)) playerNewState['account.passcode'] = playerPass.passcode\n\n\t\tconst player = await Player.findOneAndUpdate({ '_id': mongoose.Types.ObjectId(playerId) }, {$set: playerNewState}, {new: true})\n\t\tawait updatePlayerStatusAfterOrder(playerId)\n\t\tres.status(200).send('edit completed')\n\t}catch(err){\n\t\tthrow err\n\t}\n}\nexport default editPlayerSetting;"]}