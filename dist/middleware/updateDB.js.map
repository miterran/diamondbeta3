{"version":3,"sources":["../../src/middleware/updateDB.js"],"names":["fetchAllEventOdds_MW","req","res","next","findOne","usage","cooldown","format","updatedAt","sec","findOneAndUpdate","$set","buildSportLeagueTable_MW","fullResultUpdateDB_MW"],"mappings":";;;;;;;AAAA;;;;AAEA;;;;AAEA;;;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AAEO,IAAMA;AAAA,sDAAuB,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAEX,mBAASC,OAAT,CAAiB,EAAEC,OAAO,mBAAT,EAAjB,CAFW;;AAAA;AAE5BC,cAF4B;;AAAA,YAG/B,wBAASC,MAAT,CAAgB,GAAhB,IAAuB,sBAAOD,SAASE,SAAhB,EAA2BD,MAA3B,CAAkC,GAAlC,CAAvB,GAAgED,SAASG,GAH1C;AAAA;AAAA;AAAA;;AAAA;AAAA,aAI3B,mBAASC,gBAAT,CAA0B,EAAEL,OAAO,mBAAT,EAA1B,EAA0D,EAAEM,MAAM,EAAEH,WAAW,uBAAb,EAAR,EAA1D,CAJ2B;;AAAA;AAAA;AAAA,aAK3B,2CAL2B;;AAAA;AAAA;AAAA,aAM3B,2CAN2B;;AAAA;AAQlCL;AARkC;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAvB;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAcA,IAAMS;AAAA,uDAA2B,kBAAOX,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAEhC,2CAFgC;;AAAA;AAGtCA;AAHsC;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAA3B;;AAAA;AAAA;AAAA;AAAA,GAAN;;AASA,IAAMU;AAAA,uDAAwB,kBAAQZ,GAAR,EAAaC,GAAb,EAAkBC,IAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAEZ,mBAASC,OAAT,CAAiB,EAAEC,OAAO,oBAAT,EAAjB,CAFY;;AAAA;AAE7BC,cAF6B;;AAAA,YAGhC,wBAASC,MAAT,CAAgB,GAAhB,IAAuB,sBAAOD,SAASE,SAAhB,EAA2BD,MAA3B,CAAkC,GAAlC,CAAvB,GAAgED,SAASG,GAHzC;AAAA;AAAA;AAAA;;AAAA;AAAA,aAI5B,mBAASC,gBAAT,CAA0B,EAAEL,OAAO,oBAAT,EAA1B,EAA2D,EAAEM,MAAM,EAAEH,WAAW,uBAAb,EAAR,EAA3D,CAJ4B;;AAAA;AAAA;AAAA,aAK5B,wCAL4B;;AAAA;AAAA;AAAA,aAM5B,wCAN4B;;AAAA;AAAA;AAAA,aAO5B,oDAP4B;;AAAA;AAAA;AAAA,aAQ5B,sDAR4B;;AAAA;AAAA;AAAA,aAS5B,wDAT4B;;AAAA;AAWnCL;AAXmC;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAxB;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAiBP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"updateDB.js","sourcesContent":["import moment from 'moment'\n\nimport CoolDown from '../models/CoolDown'\n\nimport A1_fetch_jsonOdd_eventOdds from '../updateDB/A1_fetch_jsonOdd_eventOdds';\nimport A2_fetch_pickMon_eventOdds from '../updateDB/A2_fetch_pickMon_eventOdds';\n\nimport B1_build_SportLeague_table from '../updateDB/B1_build_SportLeague_table';\n\nimport C1_fetch_jsonOdd_result from '../updateDB/C1_fetch_jsonOdd_result';\nimport C2_fetch_pickMon_result from '../updateDB/C2_fetch_pickMon_result';\nimport D1_sync_Result_to_openBet_eventOdds from '../updateDB/D1_sync_Result_to_openBet_eventOdds';\nimport E1_determine_OpenBet_eventOdds_result from '../updateDB/E1_determine_OpenBet_eventOdds_result';\nimport F1_confirm_openBet_result_to_HistoryBet from '../updateDB/F1_confirm_openBet_result_to_HistoryBet';\n\nexport const fetchAllEventOdds_MW = async (req, res, next) => {\n\ttry{\n\t\tconst cooldown = await CoolDown.findOne({ usage: 'fetchAllEventOdds' })\n\t\tif(moment().format('X') - moment(cooldown.updatedAt).format('X') > cooldown.sec){\n\t\t\tawait CoolDown.findOneAndUpdate({ usage: 'fetchAllEventOdds' }, { $set: { updatedAt: moment() } })\n\t\t\tawait A1_fetch_jsonOdd_eventOdds()\n\t\t\tawait A2_fetch_pickMon_eventOdds()\n\t\t}\n\t\tnext()\n\t}catch(err){\n\t\tthrow err\n\t}\n}\n\nexport const buildSportLeagueTable_MW = async (req, res, next) => {\n\ttry{\n\t\tawait B1_build_SportLeague_table()\n\t\tnext()\n\t}catch(err){\n\t\tthrow err\n\t}\n}\n\nexport const fullResultUpdateDB_MW = async ( req, res, next) => {\n\ttry{\n\t\tconst cooldown = await CoolDown.findOne({ usage: 'fullResultUpdateDB' })\n\t\tif(moment().format('X') - moment(cooldown.updatedAt).format('X') > cooldown.sec){\n\t\t\tawait CoolDown.findOneAndUpdate({ usage: 'fullResultUpdateDB' }, { $set: { updatedAt: moment() } })\n\t\t\tawait C1_fetch_jsonOdd_result()\n\t\t\tawait C2_fetch_pickMon_result()\n\t\t\tawait D1_sync_Result_to_openBet_eventOdds()\n\t\t\tawait E1_determine_OpenBet_eventOdds_result()\n\t\t\tawait F1_confirm_openBet_result_to_HistoryBet()\n\t\t}\n\t\tnext()\n\t}catch(err){\n\t\tthrow err\n\t}\n}\n\n// export const fullUpdateDB_MW = async (req, res, next) => {\n// \ttry{\n// \t\tconst fullUpdateDBcooldown = await CoolDown.findOne({ usage: 'fullUpdateDB' })\n// \t\tif(moment().format('X') - moment(fullUpdateDBcooldown.updatedAt).format('X') > fullUpdateDBcooldown.sec){\n// \t\t\tawait CoolDown.findOneAndUpdate({ usage: 'fullUpdateDB' }, { $set: { updatedAt: moment() } })\n// \t\t\tconst fetchAllEventOddscooldown = await CoolDown.findOne({ usage: 'fetchAllEventOdds' })\n// \t\t\tif(moment().format('X') - moment(fetchAllEventOddscooldown.updatedAt).format('X') > fetchAllEventOddscooldown.sec){\n// \t\t\t\tawait CoolDown.findOneAndUpdate({ usage: 'fetchAllEventOdds' }, { $set: { updatedAt: moment() } })\n// \t\t\t\tawait A1_fetch_jsonOdd_eventOdds()\n// \t\t\t\tawait A2_fetch_pickMon_eventOdds()\n// \t\t\t}\n// \t\t\tconst fullResultUpdateDBcooldown = await CoolDown.findOne({ usage: 'fullResultUpdateDB' })\n// \t\t\tif(moment().format('X') - moment(fullResultUpdateDBcooldown.updatedAt).format('X') > fullResultUpdateDBcooldown.sec){\n// \t\t\t\tawait CoolDown.findOneAndUpdate({ usage: 'fullResultUpdateDB' }, { $set: { updatedAt: moment() } })\n// \t\t\t\tawait C1_fetch_jsonOdd_result()\n// \t\t\t\tawait C2_fetch_pickMon_result()\n// \t\t\t\tawait D1_sync_Result_to_openBet_eventOdds()\n// \t\t\t\tawait E1_determine_OpenBet_eventOdds_result()\n// \t\t\t\tawait F1_confirm_openBet_result_to_HistoryBet()\n// \t\t\t}\n// \t\t}\n// \t\tnext()\n// \t}catch(err){\n// \t\tthrow err\n// \t}\n// }"]}