{"version":3,"sources":["../../../src/updateDB/utils/createAgentTransaction.js"],"names":["createAgentTransaction","AgentId","newAgentTransaction","AgentTransaction","owner","superAgent","req","user","agent","_id","orderType","transactionType","creditAmount","purchaseCredit","priceAmount","purchasePrice","resultAmount","currentStatus","credit","orderNumber","newAgentDeposit","save"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;;;AAEA,IAAMA;AAAA,sDAAyB,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIzBC,yBAJyB,GAIH,IAAIC,gBAAJ,CAAqB;AAC9CC,cAAM;AACLC,oBAAaC,IAAIC,IAAJ,CAASF,UADjB;AAELG,eAAQF,IAAIC,IAAJ,CAASE;AAFZ,QADwC;AAK9CC,kBAAW,SALmC;AAM9CC,wBAAiB,IAN6B;AAO9CC,qBAAcC,cAPgC;AAQ9CC,oBAAaC,aARiC;AAS9CC,qBAAcR,MAAMS,aAAN,CAAoBC,MATY;AAU9CC,oBAAaC,gBAAgBD;AAViB,OAArB,CAJG;AAAA;AAAA,aAgBvBjB,oBAAoBmB,IAApB,EAhBuB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAzB;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBAuBerB,sB","file":"createAgentTransaction.js","sourcesContent":["import Agent from '../../models/Agent';\nimport Player from '../../models/Player'\nimport { OpenBet, HistoryBet } from '../../models/BetOrder';\nimport moment from 'moment'\nimport mongoose from 'mongoose'\nimport _ from 'lodash'\n\nconst createAgentTransaction = async (AgentId) => {\n\n\ttry {\n\n\t\tlet newAgentTransaction = new AgentTransaction({\n\t\t\towner:{\n\t\t\t\tsuperAgent : req.user.superAgent,\n\t\t\t\tagent : req.user._id\n\t\t\t},\n\t\t\torderType: 'Deposit',\n\t\t\ttransactionType: 'in',\n\t\t\tcreditAmount: purchaseCredit,\n\t\t\tpriceAmount: purchasePrice,\n\t\t\tresultAmount: agent.currentStatus.credit,\n\t\t\torderNumber: newAgentDeposit.orderNumber\n\t\t})\n\t\tawait newAgentTransaction.save()\n\t\t\n\t}catch(err){\n\t\tthrow err\n\t}\n}\n\nexport default createAgentTransaction\n\n"]}