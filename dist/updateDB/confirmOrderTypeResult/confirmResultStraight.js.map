{"version":3,"sources":["../../../src/updateDB/confirmOrderTypeResult/confirmResultStraight.js"],"names":["confirmResultStraight","openBet","betOrderStatus","resultAmount","eventOdds","status","Number","wagerDetail","winAmount","riskAmount","toFixed","console","log","orderNumber","newHistoryBet","orderType","owner","createdAt","closedAt","save","findOneAndRemove","_id"],"mappings":";;;;;;AAAA;;AACA;;;;;;;;AAEA,IAAMA;AAAA,sDAAwB,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAEzBC,oBAFyB,GAER,KAFQ;AAGzBC,kBAHyB,GAGV,CAHU;AAAA,oBAMtBF,QAAQG,SAAR,CAAkB,CAAlB,EAAqBC,MANC;AAAA,sCAOvB,KAPuB,uBAWvB,MAXuB,uBAevB,UAfuB,wBAmBvB,WAnBuB,wBAuBvB,MAvBuB,wBA2BvB,UA3BuB;AAAA;;AAAA;AAQ3BH,uBAAiB,KAAjB;AACAC,qBAAeG,OAAOL,QAAQM,WAAR,CAAoBC,SAA3B,CAAf;AAT2B;;AAAA;AAY3BN,uBAAiB,MAAjB;AACAC,qBAAe,CAACG,OAAOL,QAAQM,WAAR,CAAoBE,UAA3B,CAAhB;AAb2B;;AAAA;AAgB3BP,uBAAiB,KAAjB;AACAC,qBAAe,CAAEG,OAAOL,QAAQM,WAAR,CAAoBC,SAA3B,IAAwC,CAA1C,EAA8CE,OAA9C,EAAf;AAjB2B;;AAAA;AAoB3BR,uBAAiB,MAAjB;AACAC,qBAAe,CAAC,CAAEG,OAAOL,QAAQM,WAAR,CAAoBE,UAA3B,IAAyC,CAA3C,EAA+CC,OAA/C,EAAhB;AArB2B;;AAAA;AAwB3BR,uBAAiB,MAAjB;AACAC,qBAAe,CAAf;AAzB2B;;AAAA;AA4B3BD,uBAAiB,UAAjB;AACAC,qBAAe,CAAf;AA7B2B;;AAAA;AAgC3BQ,cAAQC,GAAR,CAAYX,QAAQY,WAAR,GAAsB,wBAAlC;AAhC2B,uCAiCpB,KAjCoB;;AAAA;AAAA,YAqC1BX,mBAAmB,KArCO;AAAA;AAAA;AAAA;;AAsCtBY,mBAtCsB,GAsCN,yBAAe;AACpCD,oBAAaZ,QAAQY,WADe;AAEpCE,kBAAWd,QAAQc,SAFiB;AAGpCC,cAAOf,QAAQe,KAHqB;AAIpCT,oBAAaN,QAAQM,WAJe;AAKpCF,eAAQH,cAL4B;AAMpCC,qBAAcA,YANsB;AAOpCC,kBAAWH,QAAQG,SAPiB;AAQpCa,kBAAWhB,QAAQgB,SARiB;AASpCC,iBAAU;AAT0B,OAAf,CAtCM;AAAA;AAAA,aAkDtBJ,cAAcK,IAAd,EAlDsB;;AAAA;AAmD5BR,cAAQC,GAAR,CAAY,+BAA+BE,cAAcD,WAAzD;AAnD4B;AAAA,aAoDtB,kBAAQO,gBAAR,CAAyB,EAAEC,KAAKpB,QAAQoB,GAAf,EAAzB,CApDsB;;AAAA;AAqD5BV,cAAQC,GAAR,CAAY,qBAAqBX,QAAQY,WAAzC;AArD4B,uCAsDrB,IAtDqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAxB;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBA8Deb,qB","file":"confirmResultStraight.js","sourcesContent":["import { OpenBet, HistoryBet } from '../../models/BetOrder';\nimport moment from 'moment'\n\nconst confirmResultStraight = async (openBet) => {\n\n\tlet betOrderStatus = 'TBD'\n\tlet resultAmount = 0\n\n\n\tswitch(openBet.eventOdds[0].status){\n\t\tcase 'Won':\n\t\t\tbetOrderStatus = 'Won'\n\t\t\tresultAmount = Number(openBet.wagerDetail.winAmount)\n\t\t\tbreak;\n\t\tcase 'Lost':\n\t\t\tbetOrderStatus = 'Lost'\n\t\t\tresultAmount = -Number(openBet.wagerDetail.riskAmount)\n\t\t\tbreak;\n\t\tcase 'Won Half':\n\t\t\tbetOrderStatus = 'Won'\n\t\t\tresultAmount = ( Number(openBet.wagerDetail.winAmount) / 2 ).toFixed()\n\t\t\tbreak;\n\t\tcase 'Lost Half':\n\t\t\tbetOrderStatus = 'Lost'\n\t\t\tresultAmount = -( Number(openBet.wagerDetail.riskAmount) / 2 ).toFixed()\n\t\t\tbreak;\n\t\tcase 'Push':\n\t\t\tbetOrderStatus = 'Push'\n\t\t\tresultAmount = 0\n\t\t\tbreak;\n\t\tcase 'Canceled':\n\t\t\tbetOrderStatus = 'Canceled'\n\t\t\tresultAmount = 0\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tconsole.log(openBet.orderNumber + ' straight not finished')\n\t\t\treturn false;\n\t}\n\n\n\tif(betOrderStatus !== 'TBD'){\n\t\tconst newHistoryBet = new HistoryBet({\n\t\t\torderNumber: openBet.orderNumber,\n\t\t\torderType: openBet.orderType,\n\t\t\towner: openBet.owner,\n\t\t\twagerDetail: openBet.wagerDetail,\n\t\t\tstatus: betOrderStatus,\n\t\t\tresultAmount: resultAmount,\n\t\t\teventOdds: openBet.eventOdds,\n\t\t\tcreatedAt: openBet.createdAt,\n\t\t\tclosedAt: moment()\n\t\t})\n\t\n\t\tawait newHistoryBet.save()\n\t\tconsole.log('saved history straight bet' + newHistoryBet.orderNumber)\n\t\tawait OpenBet.findOneAndRemove({ _id: openBet._id })\n\t\tconsole.log('deleted openbet ' + openBet.orderNumber)\n\t\treturn true\n\n\t}\n\n\n\n}\n\nexport default confirmResultStraight"]}